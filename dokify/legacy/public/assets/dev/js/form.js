define(["network"],function(c){function e(i){var g,h;this.dom=i;this.name=$(i).attr("name");this.checked=$(i).is(":checked");g=this;h=$(i).attr("uncheckable")!==undefined;
if(h){$(i).on("click",function(j){if(g.checked){g.uncheck(j);}else{g.checked=true;}$(i.form).find("input[name="+this.name+"]").not(i).trigger("internal_change");
return true;});$(i).on("internal_change",function(j){g.checked=$(this).is(":checked");});}}e.prototype.uncheck=function(){$(this.dom).removeAttr("checked").trigger("change");
this.checked=false;};function d(i){var h,g;h=this;this.dom=i;this.customValidity=$(i).data("custom-validity");$(i).blur(function(j){h.blur(j);});if(this.customValidity&&i.setCustomValidity){$(i).on("invalid",function(j){h.invalid(j);
});$(i).on("input",function(j){h.input(j);});}}d.prototype.input=function(g){this.dom.setCustomValidity("");};d.prototype.invalid=function(g){this.dom.setCustomValidity(this.customValidity);
};d.prototype.parse=function(g){if(g.empty){$(this.dom).val("");}};d.prototype.blur=function(k){var g=this,h,l,j;h=$(this.dom).attr("name");l=$(this.dom).val();
j=$(this.dom).data("remote");if(j){var i={};i[h]=l;$(g.dom).addClass("loading");$.ajax({url:j,data:i,dataType:"json",complete:function(){$(g.dom).removeClass("loading");
},success:function(m){$(document).trigger("json:response",[m]);if(m.input){g.parse(m.input);}}});}};d.prototype.customValidation=function(){if(this.dom.required!==undefined&&this.customValidity&&!$(this.dom).val()){alert(this.customValidity);
return false;}return true;};function f(k){var g=this,j;this.dom=$(k);j=this.dom.prop("required");if(this.dom.hasClass("chosen")){require.css("/css/chosen");
require(["vendor/chosen.jquery"],function(){var l=g.dom.data("chosen-empty")||false;g.dom.chosen({no_results_text:l,inherit_select_classes:true,search_contains:true});
if(j){g.dom.prop("required",false).addClass("required");}});}this.customValidity=$(k).data("custom-validity");if(this.customValidity&&k.setCustomValidity){$(k).on("invalid",function(l){g.invalid(l);
});$(k).on("change",function(l){g.change(l);});}this.dom.on("error",function(n){var m,l;l=g.dom.data("chosen");if(!l){return;}l.container.addClass("error");
if(g.customValidity){alert(g.customValidity);}g.dom.one("change",function(){l.container.removeClass("error");});});f.prototype.change=function(l){k.setCustomValidity("");
};f.prototype.invalid=function(l){k.setCustomValidity(this.customValidity);};f.prototype.customValidation=function(){if(k.required!==undefined&&this.customValidity&&!$(k).val()){alert(this.customValidity);
return false;}return true;};function i(l){g.dom.html(l);$(g.dom).trigger("chosen:updated");}function h(){var l=g.dom.data("src");if(l){$.get(l,i);}}if(this.dom.data("src")!==undefined){this.dom.one("focus",h);
this.dom.one("chosen:showing_dropdown",h);}this.dom.on("fetch",h);}function a(j){var g=this;var i=$(j.form);this.dom=$(j);var h=i.find("button[type=submit], button.submit");
h.each(function(){var k=$(this);g.dom.on("complete",function(){k.removeAttr("disabled");});g.dom.on("change",function(){k.attr("disabled","disabled");});
});}function b(j){var g,i,h;this.form=$(j);this.button=null;g=this;i=this.form.attr("target");if(i!==undefined){return;}this.form.on("click","input[type=submit], button[type=submit]",function(k){return g.click(k,this);
});this.form.submit(function(k){return g.submit(k,this);});this.form.find("input[type=text], input[type=email]").each(function(){new d(this);});this.form.find("input[type=radio]").each(function(){new e(this);
});this.form.find("select").each(function(){new f(this);});this.form.find("input[type=file]").each(function(){new a(this);});trigger=this.form.data("trigger");
if(trigger){trigger=this.form.find("[name="+trigger+"]");if(trigger.length){trigger.each(function(){switch(this.tagName.toLowerCase()){case"select":$(this).on("change",function(k){g.submit(k);
});break;case"input":switch(this.type){case"radio":$(this).on("change",function(k){g.submit(k);});break;}break;}});}}}b.prototype.click=function(g){this.button=$(g.currentTarget||g.target);
return true;};b.prototype.submit=function(x){var o,n,A,q,v,k,w,j,m,z,g,t,h;x.preventDefault();o=this;q=this.form.attr("action");j=this.form.attr("method")||"post";
A=this.form.serializeArray();m=this.form.data("empty-confirm");v=this.form.data("navigate")!==undefined;t=this.form.find("button[type=submit], button.submit");
k=this.form.data("loading");h=this.form.data("location")==false?this.form.data("location"):true;w=this.form.data("response");if(m&&A.length==0){if(!confirm(m)){return false;
}}if(typeof document.createElement("input").checkValidity!="function"){var p=true;this.form.find("input").each(function(i,B){input=new d(B);if(false===input.customValidation()){p=false;
}});this.form.find("select").each(function(i,B){select=new f(B);if(false===select.customValidation()){p=false;}});if(false===p){return false;}}else{this.form.find("select.chosen.required").each(function(){if($(this).val()){return;
}$(this).trigger("error");p=false;});if(false===p){return false;}}if(this.button){var r=this.button.attr("value");if(r){A.push({name:this.button.attr("name"),value:r});
}g=$(this.button).html();z=$(this.button).data("submit-text");$(this.button).attr("disabled","disabled");if(z){$(this.button).html(z);}}if(j=="get"&&h){var l,u,y=[];
for(var s in A){if(A[s].value!=""){y.push(A[s].name+"="+encodeURIComponent(A[s].value));}}u=q.indexOf("?")===-1?"?":"&";l=q+u+y.join("&");return $(document).trigger("location",[l]);
}if(k){if(k===true){this.form.addClass("loading");}else{this.form.find(k).addClass("loading").removeClass("normal");}}else{}n=$.ajax({type:j,data:A,url:q,beforeSend:function(i){if(w){i.setRequestHeader("Dom",w);
}if(v){$(document).trigger("navigate:lock");$(document).trigger("navigate:before",[i]);}if(t){t.addClass("disabled");t.attr("disabled","disabled");}},error:function(C,i,B){if(v){$(document).trigger("navigate:stop",[C]);
}contentType=C.getResponseHeader("Content-type");isDrawable=contentType.indexOf("text/plain")!==-1||contentType.indexOf("text/html")!==-1;if(isDrawable){$(document).trigger("navigate:error",[C]);
return;}isJson=contentType.indexOf("application/json")!==-1;if(isJson){c.parseResponse($.parseJSON(C.responseText),status,C);}},success:function(H,E,M){var G={},K,B,L;
if(t&&v!==true){t.removeClass("disabled");t.removeAttr("disabled");}K=M.getResponseHeader("Content-type");B=K.indexOf("text/plain")!==-1||K.indexOf("text/html")!==-1;
if(o.button){$(o.button).removeAttr("disabled");$(o.button).html(g);}if(B){$(document).trigger("navigate:response",[H,E,M]);$(document).trigger("navigate:after",[M]);
}else{L=H.errors||H["message:error"];c.parseResponse(H,E,M);if(v&&L){$(document).trigger("navigate:stop",[M]);}if(t&&L){t.removeClass("disabled").removeAttr("disabled");
}if(H.errors){var D,I,F,J,C;for(F in H.errors){C=jQuery.Event("error");D=H.errors[F];I=new Error(D.message);for(J in D){I[J]=D[J];}o.form.trigger(C,I);
if(C.isDefaultPrevented()===false){throw I;}}}}},complete:function(){if(k&&v!==true){if(k===true){o.form.removeClass("loading");}else{o.form.find(k).addClass("normal").removeClass("loading");
}}if(t&&v!==true){t.removeClass("disabled");t.removeAttr("disabled");}}});return true;};b.init=function(){var h=this,g=$(this).data("lazy")===true;function i(){if($(h).is(":visible")){$(document).off("appear",i);
return new b(h);}}if(g){$(document).on("appear",i);}else{return new b(this);}};return b;});