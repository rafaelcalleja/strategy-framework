(function(a,b){a.enableAdvancedSearch=function(f){var j=$(f),c=forms=j.find(".advanced-search-form"),e=j.find("#advanced-search-content"),g=j.find("#buscador-avanzado");
var h=function(p,m){var k=$(c[forms.length-1]),q=k.clone(true).appendTo(e),n=$(p).closest("td"),r=k.find(".action-buttons").empty(),o=q.find(".action-buttons"),s=$(document.createElement("input")).attr({type:"hidden",name:"concat",value:m}).appendTo(n);
$(o).find(".remove-form").remove();var l=$(document.createElement("button")).addClass("btn remove-form").html("<span><span>"+agd.strings.quitar_filtro+"</span></span>").click(function(){var v=$(this.form),t=v.prev(),u=$(t).find(".action-buttons");
if($(".advanced-search-form").length<=2){$(this).remove();}$("input[name='concat']",t).remove();$(".action-buttons button",v).clone(true).appendTo(u);$(v).remove();
$.fn.colorbox.resize();return false;}).appendTo(o);if(m==" "){$(q[0].string).val("").closest("tr").css("display","none");}else{$(q[0].string).val("").closest("tr").css("display","");
}$.fn.colorbox.resize();return q[0];};var d=function(){var k=j.find(".advanced-search-form"),p=k.length,q=[];for(i=0;i<p;i++){var l=k[i],n=[],u=$.trim($(l.string).attr("value")),o=$.trim($(l.docs).val()),s=$.trim($(l.tipo).val()),v=$(l.asignado).val(),m=$(l.estado).val(),t=$(l.papelera).val();
if(s){n.push("tipo:"+encodeURIComponent(s));}if(m){n.push("estado:"+m);}if(!isNaN(o)){n.push("docs:"+encodeURIComponent(o));}if(!isNaN(v)){n.push("asignado:"+encodeURIComponent(v));
}if(u){n.push(encodeURIComponent(u));}if(n.length&&(!isNaN(t)||t=="all")){n.push("papelera:"+t);}var w=n.join(" ");if($.trim(w)){q.push(w);if(l.concat&&n.length){q.push(encodeURIComponent($(l.concat).val()));
}}}var w=q.join(""),r="buscar.php?p=0&q="+w;if(!w.length){alert("Por favor introduce los criterios de busqueda");return false;}$.fn.colorbox.close();location.hash=r;
return false;};j.find("#mas-and").click(function(){var k=h(this," ");return false;});j.find("#mas-or").click(function(){var k=h(this,"+");return false;
});c.submit(d);g.click(d);j.find("#agrupamiento-asignado").change(function(){var l=this,m=$(l).val(),k="query.php?t=agrupador&f=uid_agrupamiento&v="+m;
$.get(k,function(p){var n=agd.func.getJson(p),q=$("#asignado",$(l).closest("form"));$(":not(.default)",q).remove();var o=(l.selectedIndex!=0)?"Seleccionar "+$(":selected",l).text():"&laquo;&laquo;&laquo;";
$(".default",q).html(o);$.each(n,function(r,s){$(document.createElement("option")).prop({innerHTML:s.nombre,value:s.oid}).appendTo(q);});});});};})(window);
